{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observe/array.js","../../src/observe/index.js","../../src/state.js","../../compiler/parser-html.js","../../compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["/**\n * \n * @param {*} data 当前数据是不是对象\n * @returns \n */\nexport function isObject(data) {\n    return typeof data === 'object' && data !== null\n}\n/**\n * 定义一个不可枚举的属性\n * @param {*} data \n * @param {*} key \n * @param {*} value \n */\n\nexport function def(data,key,value) {\n    Object.defineProperty(data,key,{\n        enumerable:false,\n        configurable:false,\n        value\n    })\n}","// 重写数组的7个方法 push  shift unshift pop reverse sort splice\n// slice不会改变原数组\n\nlet oldArrayMethods = Array.prototype\n\n// value.__protp__ = arrayMethods\n// arrayMethods.__proto__ = oldArrayMethods\nexport const arrayMethods = Object.create(oldArrayMethods)\n\nconst methods = [\n    'push',\n    'shift',\n    'unshift',\n    'pop',\n    'reverse',\n    'sort',\n    'splice',\n]\n\nmethods.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        console.log('用户调用了push'); // AOP切片编程\n        const result = oldArrayMethods[method].apply(this,args) // 调用原生的数组方法\n        // push unshift 添加的元素可能还是一个对象\n        let inserted;\n        let ob = this.__ob__\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;  \n                break;\n            case 'splice': // 3个 新增的属性 splice 有删除 新增的功能 arr.splice(0,1,{name:1})\n                inserted = args.slice(2)\n            default:\n                break;\n        }\n\n        if(inserted) ob.observerArray(inserted)\n\n        return result\n    }\n})","import {isObject,def} from '../util/index'\nimport {arrayMethods} from './array.js'\n// 把data中的数据 都重新定义\n// 但Object.defineProperty 不能兼容ie8及以下 所以vue2无法兼容ie8\n\nclass Observer{\n    constructor(value) {\n        // 如果是数组，会对索引也添加set和get，最好对数组再进行特殊处理\n        // value.__ob__ = this // 给每一个监控过的对象都加一个属性\n        def(value,'__ob__',this)\n        if(Array.isArray(value)) {\n            // 不要对索引进行观测，影响性能\n            // 如果数组里放的是对象，再监控\n\n\n            // push shift 劫持\n\n            value.__proto__ = arrayMethods\n            this.observerArray(value)\n        }else {\n            // vue如果数据的层次过多 需要第一的去解析对象中的和属性，依次增加set和get方法\n            // vue3 的proxy 不用递归也不用加set和get\n            this.walk(value)\n        }\n        \n\n        \n    }\n    observerArray(value) { // [{}]\n        for(let i = 0; i < value.length; i++) {\n            observe(value[i])\n        }\n    }\n    // 遍历对象用\n    walk(data) {\n        let keys = Object.keys(data) // [name,age,address] ,对象中属性组成的数组\n        keys.forEach((key)=>{\n            defineReactive(data,key,data[key])\n        })\n\n        // for ( let i = 0; i < keys.length; i++ ) {\n        //     let key = keys[i]; // 取第i个属性\n        //     let value = data[key]; // 取第i个值\n        //     defineReactive(data,key,value) // 把这个key value变成响应式\n        // }\n    }\n}\n\nfunction defineReactive(data,key,value) {\n    observe(value) // 是不是对象 递归实现深度检测 \n    Object.defineProperty(data,key,{\n        get() {\n            return value;\n        },\n        set(newValue) {\n            if( newValue === value) return;\n            console.log('值发生变化了');\n            observe(newValue) // 如果用户将一个值重新赋值成对象，需要劫持时做响应式\n            value = newValue\n        }\n    })\n}\n// 是不是对象\nexport function observe(data) {\n    let isObj = isObject(data)\n    // 不是对象\n    if(!isObj) {\n        return\n    }\n    // 是对象 需要观测数据 \n    return new Observer(data)\n    \n}","import {observe} from './observe/index'\nexport function initState(vm) {\n    // vue的数据来源 属性 方法 数据 计算属性 watch ,也是vue的初始化流程\n    const opts = vm.$options\n    // console.log(opts);\n    if (opts.props) {\n        initProps(vm)\n    }\n    if (opts.method) {\n        initMethods(vm)\n    }\n    if (opts.data) {\n        initData(vm)\n    }\n    if (opts.computed) {\n        initComputed(vm)\n    }\n    if (opts.watch) {\n        initWatch(vm)\n    }\n}\nfunction initProps(){}\nfunction initMethods(){}\nfunction initData(vm){\n    // 数据初始化\n    let data = vm.$options.data; // 用户传递的data\n    data = vm._data = typeof data === 'function' ? data.call(vm):data // data可能是个函数（返回值是对象），也可能是对象，只需要对象\n    console.log(data);\n    // 数据劫持 用户改变数据时 希望可以得到通知 -> 刷新页面\n    // MVVM模式 数据驱动视图变化\n    // Object.defineProperty() 给属性添加get和set方法\n    observe(data) // 响应式\n}\nfunction initComputed(){}\nfunction initWatch(){}","// ast语法树 是用对象来描述js语法的  虚拟dom  用对象来描述dom节点的\n// ?: 匹配不捕获\n\n// arguments[0] 匹配到的标签 arguments[1] 匹配到的标签名字\n// let r  = '<ab:cd>'.match(startTagOpen)\n// console.log(r);  ['<ab:cd','ab:cd']\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // abc-aaa 两个斜杠：字符串一层正则一层\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // <aaa:dasda> 命名空间标签\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);// 匹配标签结尾的</div>\n\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的 可以是双引号、单引号或者为空\n//console.log(`  aa=123`.match(attribute));\n\nconst startTagClose = /^\\s*(\\/?)>/ // 匹配标签结束的> 包含自闭合 <div />\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g  // 匹配花括号{{}}\n\nlet root = null; // ast语法树的树根\nlet currentParent; // 标识当前父亲是谁\nlet stack = [];\nconst ELEMENT_TYPE = 1;\nconst TEXT_TYPE = 3;\n\nfunction createASTElement(tagName,attrs) {\n    return {\n        tag:tagName,\n        type:ELEMENT_TYPE,\n        children:[],\n        attrs,\n        parent:null\n    }\n}\n\nfunction start(tagName,attrs) {\n    // 遇到开始标签 就创建一个ast元素\n    console.log('开始标签',tagName,'属性是:',attrs);\n\n    let element = createASTElement(tagName,attrs)\n    if(!root) {\n        root =element;\n    }\n    currentParent = element; // 把当前元素标记成父ast树\n    stack.push(element)\n}\nfunction chars(text) {\n    console.log('文本是',text);\n    text = text.replace(/\\s/g,'')\n    if(text) {\n        currentParent.children.push({\n            text,\n            type:TEXT_TYPE\n        })\n    }\n}\nfunction end(tagName) {\n    console.log('结束标签：',tagName);\n    let element = stack.pop(); // 拿到的是ast对象\n    // TODO: 是不是同一个 如 <div><p></a></p></div>\n    // 要表示当前这个p是属于这个div的儿子的\n    currentParent = stack[stack.length-1]\n    if(currentParent) {\n        element.parent = currentParent\n        currentParent.children.push(element) // 实现了一个树的父子关系\n    }\n}\nexport function parseHTML(html) {\n    // 不停的解析html\n    while (html) {\n        let textEnd = html.indexOf('<')\n        if (textEnd == 0) {\n          \n            // 如果当前索引为0 肯定是一个标签 开始标签 结束标签\n            let startTagMatch = parseStartTag(); // 通过这个方法获取到匹配的结果 tagName,attrs\n            if(startTagMatch) {\n                start(startTagMatch.tagName,startTagMatch.attrs) // 1解析开始标签\n                // console.log(666,startTagMatch);\n                continue; // 如果开始标签匹配完毕后 继续下一次 匹配\n            }\n            let endTagMatch = html.match(endTag);\n            if (endTagMatch) {\n                advance(endTagMatch[0].length)\n                end(endTagMatch[1]); // 2解析结束标签\n                continue;\n            }\n        }\n        let text;\n        if (textEnd >= 0){\n            text = html.substring(0,textEnd)\n        }\n        if (text){\n            advance(text.length)\n            chars(text) // 3解析文本\n        }\n    }\n    function advance(n) {\n        html = html.substring(n)\n    }\n    function parseStartTag() {\n        let start = html.match(startTagOpen);\n        if (start) {\n            const match = {\n                tagName: start[1],\n                attrs: []\n            }\n            // console.log('-----',start);\n            advance(start[0].length) // <div 将标签删除\n            // console.log(html);\n            let end,attr;\n            while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                // 将属性进行解析\n                advance(attr[0].length); // 将属性去掉\n                match.attrs.push({\n                    name:attr[1],\n                    value:attr[3]||attr[4]||attr[5]\n                })\n            }\n            if (end) { // 去掉开始标签的 >\n                advance(end[0].length);\n                return match\n            }\n            // console.log(match,html);\n        }\n        \n    }\n    return root;\n}\n","import {parseHTML} from './parser-html'\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g  // 匹配花括号{{}}\nfunction genChildren(el) {\n    let children  = el.children\n    if(children && children.length>0){\n        return `${children.map((c)=>gen(c)).join(',')}`\n    }else {\n        return false;\n    }\n}\n\nfunction gen(node) {\n    if(node.type == 1){\n        // 元素标签\n        return generate(node)\n    }else{\n        // 文字标签\n        let text = node.text; // a {{name}} b {{age}} c\n        // _v(\"a\"+_s(name)+\"b\"+_s(age)+\"c\")\n        // 这里使用正则匹配，exec可以全取到，match只能取到name、age\n        let tokens = [];\n        let match,index;\n        let lastIndex = defaultTagRE.lastIndex = 0\n        while(match = defaultTagRE.exec(text)){\n            index = match.index;\n            if(index > lastIndex){\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)))\n            }\n            tokens.push(`_s(${match[1].trim()})`);\n            lastIndex = index + match[0].length\n            \n        }\n        // 最后多余的字符串\n        if(lastIndex < text.length){\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\n        }\n        return `_v(${tokens.join('+')})`\n    }\n}\n\nfunction genProps(attrs) {\n    let str = ''\n    for(let i = 0; i < attrs.length; i++){ // [{name:'id',value:'app'}]\n        let attr = attrs[i];\n        if(attr.name == 'style'){\n            // style=\"color:red;fontSize:14px\" => style:{color:'red}.id:name\n            let obj = {};\n            attr.value.split(';').forEach((item)=>{\n                let [key,value] = item.split(':')\n                obj[key] = value;\n            })\n            attr.value = obj\n        }\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\n    }\n    return `{${str.slice(0,-1)}}`\n}\n\nfunction generate(el) {\n    let children = genChildren(el)\n    let code = `_c(\"${el.tag}\",${el.attrs.length?genProps(el.attrs):'undefined'}${children?`,${children}`:''})`\n    return code\n}\n\nexport function compileToFunction(template) {\n    // 1）解析html字符串 -》 ast语法树\n    let root = parseHTML(template)\n    // 需要将ast语法树转成render函数\n    let code  = generate(root)\n    // with为了拿到data中的数据\n    // function () {\n    //     with(this){  this为vm实例 vm.render\n    //         return _c(\"div\",{id:\"app\",style:{\"color\":\"red\",\"background-color\":\" blue\"}},_v(\"hello\"),_c(\"p\",undefined,_v(\"123\"+_s(address))))\n    //     }\n    // }\n    let renderFn = new Function(`with(this){ return ${code}}`)\n    console.log(root,'---');\n    return renderFn;\n}\n\n// 结点\n{/* <div id=\"app\">\n    <p>hello</p>\n</div>\n\n// 语法\nlet root = {\n    tag:'div',\n    attrs:[{name:'id',value:'app'}],\n    parent:null,\n    type:1, // 元素\n    children:[{\n        tag:'p',\n        attrs:[],\n        parent:root,\n        type:1, // 元素\n        children:[{\n            text:'hello',\n            type:3, // 文本\n        }]\n    }]\n} */}","import {initState} from './state'\nimport { compileToFunction } from '../compiler/index.js';\n// 在原型上增加一个init方法\nexport function initMixin(Vue) {\n    // 初始化流程\n    Vue.prototype._init = function (options) {\n        console.log(options);\n        const vm = this\n        vm.$options = options // 用户传递的属性 data,watch\n\n        // 初始化状态\n        initState(vm) \n\n\n\n\n        // 如果用户传入了el属性 需要将页面渲染出来 \n        // 实现挂在流程\n        if(vm.$options.el) {\n            vm.$mount(vm.$options.el)\n        }\n\n    }\n    Vue.prototype.$mount = function (el) {\n        const vm = this;\n        const options = vm.$options\n        el = document.querySelector(el); // 返回一个dom元素\n\n        // 默认会先查找有没有render  没有render会用template 没有template用el中的内容\n\n        if(!options.render) {\n            // 对模版进行编译\n            let template = options.template; // 取出模版\n            if(!template && el) {\n                template = el.outerHTML // 整个div  \n            }\n            console.log(template);\n            const render = compileToFunction(template);\n            console.log('render:',render);\n            options.render = render\n            // 需要把template 转换成render函数  vue1.0用的正则 vue2.0虚拟dom\n        }\n        // options.render\n    }\n}","import {initMixin} from './init.js'\nfunction Vue(options) {\n    this._init(options)\n}\n// 通过文件引入的方式，给vue原型挂载方法\ninitMixin(Vue)\nexport default Vue"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","oldArrayMethods","Array","prototype","arrayMethods","create","methods","forEach","method","console","log","args","result","apply","inserted","ob","__ob__","slice","observerArray","Observer","isArray","__proto__","walk","i","length","observe","keys","defineReactive","get","set","newValue","isObj","initState","vm","opts","$options","props","initData","computed","watch","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","tag","type","children","parent","start","element","push","chars","text","replace","end","pop","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genChildren","el","map","c","gen","join","node","generate","tokens","index","lastIndex","exec","JSON","stringify","trim","genProps","str","obj","split","item","code","compileToFunction","template","renderFn","Function","initMixin","Vue","_init","options","$mount","document","querySelector","render","outerHTML"],"mappings":"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"}